{% extends "base.html" %}

{% block header_title %}Axela{% endblock %}

{% block content %}
{% set is_empty = stats.projects == 0 %}

{% if is_empty %}
<!-- Empty State -->
<div class="empty-state">
    <i>all_inbox</i>
    <h5 style="margin-top: 16px;">Добро пожаловать</h5>
    <p class="secondary-text">
        Axela собирает обновления из ваших рабочих инструментов и отправляет дайджест в Telegram
    </p>
    <button class="large round" onclick="location.href='{{ url_for('projects_list') }}?action=new'" style="margin-top: 24px;">
        <i>add</i>
        <span>Создать проект</span>
    </button>
</div>

{% else %}
<!-- Stats Row -->
<div style="display: flex; gap: 12px; margin-bottom: 24px;">
    <div class="card" style="flex: 1; text-align: center;">
        <div class="card-body">
            <div style="font-size: 24px; font-weight: 600;">{{ stats.projects }}</div>
            <div class="secondary-text" style="font-size: 12px;">проектов</div>
        </div>
    </div>
    <div class="card" style="flex: 1; text-align: center;">
        <div class="card-body">
            <div style="font-size: 24px; font-weight: 600;">{{ stats.sources }}</div>
            <div class="secondary-text" style="font-size: 12px;">источников</div>
        </div>
    </div>
    <div class="card" style="flex: 1; text-align: center;">
        <div class="card-body">
            <div style="font-size: 24px; font-weight: 600;">{{ stats.digests_sent }}</div>
            <div class="secondary-text" style="font-size: 12px;">дайджестов</div>
        </div>
    </div>
</div>

<!-- Next Step Banner -->
{% if stats.sources == 0 %}
<div class="card primary-container" style="margin-bottom: 24px;">
    <a href="{{ url_for('sources_list') }}" class="list-tile" style="text-decoration: none; color: inherit;">
        <div class="leading" style="background: var(--primary); color: var(--on-primary);">
            <i>cloud</i>
        </div>
        <div class="content">
            <p class="title">Добавьте источники</p>
            <p class="subtitle">Jira, Slack, Gmail, Calendar</p>
        </div>
        <i class="trailing">arrow_forward</i>
    </a>
</div>
{% elif stats.schedules == 0 %}
<div class="card primary-container" style="margin-bottom: 24px;">
    <a href="{{ url_for('schedules_list') }}" class="list-tile" style="text-decoration: none; color: inherit;">
        <div class="leading" style="background: var(--primary); color: var(--on-primary);">
            <i>schedule</i>
        </div>
        <div class="content">
            <p class="title">Настройте расписание</p>
            <p class="subtitle">Когда получать дайджест</p>
        </div>
        <i class="trailing">arrow_forward</i>
    </a>
</div>
{% endif %}

<!-- Projects Section -->
<div class="section-header">Проекты</div>
<div class="card">
    {% for project in recent_projects %}
    <a href="{{ url_for('sources_list') }}?project={{ project.id }}" class="list-tile" style="text-decoration: none; color: inherit;">
        <div class="leading" style="{% if project.color %}background: {{ project.color }};{% endif %}">
            <i style="{% if project.color %}color: white;{% endif %}">folder</i>
        </div>
        <div class="content">
            <p class="title">{{ project.name }}</p>
            <p class="subtitle">{{ project.sources_count }} источников</p>
        </div>
        <i class="trailing">chevron_right</i>
    </a>
    {% if not loop.last %}<div class="divider" style="margin-left: 72px;"></div>{% endif %}
    {% endfor %}
</div>

{% endif %}
{% endblock %}
